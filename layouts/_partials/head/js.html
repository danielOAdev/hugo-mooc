{{- with resources.Get "recursos/js/init.js" -}}
<script src="{{ .RelPermalink }}"></script>
{{- end -}}

{{- /* Google Analytics - dataLayer e função gtag */}}
{{- if not site.Config.Privacy.GoogleAnalytics.Disable }}
    {{- with site.Config.Services.GoogleAnalytics.ID }}
        <script>Object.defineProperty(globalThis, 'gTagID', {value: "{{ . }}",writable: false});</script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
        </script>
    {{- end }}
{{- end -}}

{{/* Import map para popperjs */}}
<script type="importmap">
    {
        "imports": {
        {{ with resources.Get "recursos/js/popperjs/core/dist/esm/popper.js" }}
            "@popperjs/core":"{{ partial "funcao/linkRelativo.html" (dict "Page" $ "url" .RelPermalink) }}"
        {{ end }}
        }
    }
</script>

{{/*  Como não estamos usando "js.Build", temos que publicar manualmente módulos importados.  */}}
{{- range resources.Match "recursos/js/**" -}}
    {{- .Publish -}}
{{- end -}}

{{/*  Barrel module  */}}
{{- with resources.Get "recursos/js/index.mjs" -}}
    <script type="module" src="{{ .RelPermalink }}"></script>
    {{- if ne hugo.Environment "production" -}}
        {{/*  Adiciona exportações ao escopo global quando no ambiente de desenvolvimento.  */}}
        {{ $link := partial "funcao/linkRelativo.html" (dict "Page" $ "url" .RelPermalink) }}
        <script async>import('{{ $link }}').then(modulos => { Object.assign(globalThis, modulos) });</script>
    {{- end -}}
{{- end -}}

{{/*  Google Analytics - gtag.js  */}}
{{- if not site.Config.Privacy.GoogleAnalytics.Disable }}
    {{- with site.Config.Services.GoogleAnalytics.ID }}
        <script async src="https://www.googletagmanager.com/gtag/js?id={{ . }}"></script>
    {{- end }}
{{- end -}}
