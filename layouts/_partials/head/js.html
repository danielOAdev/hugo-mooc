<script type="importmap">
  {
    "imports": {
      {{- with resources.Get "/js/popperjs/core/dist/esm/popper.js" }}
        "@popperjs/core": "{{ .RelPermalink }}"
      {{- end }}
        "vigi/": "{{ urls.AbsURL "" }}js/vigi/"
  }
}
</script>

{{/*
  Como não estamos usando "js.Build", temos que publicar manualmente módulos importados.
*/}}
{{- range resources.Match "js/**" }}
  {{ .Publish }}
{{- end }}

{{/*
  Vigi Barrel module
*/}}
{{- with resources.Get "js/index.mjs" }}
  <script type="module" src="{{ .RelPermalink }}"></script>
  {{- if eq hugo.Environment "development" }}
    {{/*  Adiciona exportações ao escopo global  */}}
    <script async>import('{{ .RelPermalink }}').then(vigi => {Object.assign(globalThis, vigi)});</script>
  {{- end }}
{{- end }}